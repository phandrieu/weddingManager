{% extends 'base.html.twig' %}

{% block title %}Détail du chant{% endblock %}

{% block body %}
<div class="container mt-4">
    <h1>Détails du chant {{ song.name }}</h1>

    <ul class="list-group">
        <li class="list-group-item"><strong>Titre :</strong> {{ song.name }}</li>
        <li class="list-group-item">
    <strong>Catégories :</strong>
    {% if song.types is not empty %}
        {% for t in song.types %}
            <span class="badge bg-primary me-1">{{ t.name }}</span>
        {% endfor %}
    {% else %}
        Aucune
    {% endif %}
</li>
        <li class="list-group-item">
            <strong>Preview :</strong>
            {% if song.previewUrl %}
                {% set youtubeId = song.previewUrl 
                    |replace({'https://youtu.be/':'', 
                              'https://www.youtube.com/watch?v=':'', 
                              '&feature=youtu.be':'', 
                              '&si=':''}) 
                %}
                <div class="ratio ratio-16x9">
                    <iframe src="https://www.youtube.com/embed/{{ youtubeId }}" 
                            title="{{ song.name }}" allowfullscreen></iframe>
                </div>
            {% else %}
                Aucune
            {% endif %}
        </li>
        <li class="list-group-item"><strong>Paroles :</strong><br>{{ song.lyrics|nl2br }}</li>
        <li class="list-group-item">
            <strong>Partition PDF :</strong>
            {% if song.partitionPDFName %}
                <a href="{{ asset('uploads/song_pdf/' ~ song.partitionPDFName) }}" target="_blank">
                    Télécharger le PDF
                </a>
            {% else %}
                Aucune
            {% endif %}
        </li>
        <li class="list-group-item"><strong>Ajouté par :</strong> {{ song.addedBy ? song.addedBy.fullName : '—' }}</li>
        <li class="list-group-item"><strong>Dernière modification par :</strong> {{ song.lastEditBy ? song.lastEditBy.fullName : '—' }}</li>
    </ul>

    <a href="{{ path('app_song_index') }}" class="btn btn-secondary mt-3">Retour</a>
</div>
{% endblock %}