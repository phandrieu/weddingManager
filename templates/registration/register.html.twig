{% extends 'base.html.twig' %}

{% block title %}Inscription{% endblock %}

{% block body %}
<div class="container mt-5">
    <h1 class="text-center mb-4">Inscription</h1>

    <form method="POST" id="registrationForm">
        <!-- Page 1 -->
        <div class="step active" id="step1">
            <div class="mb-3">
                <label>Nom</label>
                <input type="text" name="name" class="form-control" required>
            </div>
            <div class="mb-3">
                <label>Prénom</label>
                <input type="text" name="firstName" class="form-control" required>
            </div>
            <button type="button" class="btn btn-primary next">Suivant</button>
        </div>

        <!-- Page 2 -->
        <div class="step" id="step2">
            <label>Statut</label>
            <select name="status" class="form-select" required id="statusSelect">
                <option value="">-- Choisir --</option>
                <option value="musicien">Musicien</option>
                <option value="marie">Futur marié</option>
            </select>
            <button type="button" class="btn btn-secondary prev">Retour</button>
            <button type="button" class="btn btn-primary next">Suivant</button>
        </div>

        <!-- Page 3 -->
        <div class="step" id="step3">
            <div class="mb-3">
                <label>Email</label>
                <input type="email" name="email" class="form-control" required>
            </div>
            <div class="mb-3">
                <label>Téléphone</label>
                <input type="text" name="telephone" class="form-control">
            </div>
            <div class="mb-3">
                <label>Adresse</label>
                <input type="text" name="addressLine1" class="form-control">
            </div>
            <div class="mb-3">
                <label>Complément</label>
                <input type="text" name="addressLine2" class="form-control">
            </div>
            <div class="mb-3">
                <label>Code postal + Ville</label>
                <input type="text" name="addressPostalCodeAndCity" class="form-control">
            </div>
            <button type="button" class="btn btn-secondary prev">Retour</button>
            <button type="button" class="btn btn-primary next">Suivant</button>
        </div>

        <!-- Page 4 -->
        <div class="step" id="step4">
            <div class="mb-3">
                <label>Mot de passe</label>
                <input type="password" name="password" class="form-control" required>
            </div>
            <div class="mb-3">
                <label>Répéter le mot de passe</label>
                <input type="password" name="confirm_password" class="form-control" required>
            </div>

            <!-- Choix abonnement (musicien uniquement) -->
            <div id="subscriptionChoice" style="display:none;">
                <p><strong>Choisissez votre mode d’accès :</strong></p>
                <div class="form-check">
                    <input class="form-check-input" type="radio" name="subscription" value="0" checked>
                    <label class="form-check-label">Accès gratuit (paiement au mariage créé)</label>
                </div>
                <div class="form-check">
                    <input class="form-check-input" type="radio" name="subscription" value="1">
                    <label class="form-check-label">Abonnement 20€ / mois</label>
                </div>
            </div>

            <button type="button" class="btn btn-secondary prev">Retour</button>
            <button type="submit" class="btn btn-success">S'inscrire</button>
        </div>
    </form>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const steps = document.querySelectorAll('.step');
    let currentStep = 0;

    function showStep(index) {
        steps.forEach((step, i) => {
            step.classList.toggle('active', i === index);
        });
        currentStep = index;
    }

    document.querySelectorAll('.next').forEach(btn => {
        btn.addEventListener('click', () => {
            showStep(currentStep + 1);
        });
    });

    document.querySelectorAll('.prev').forEach(btn => {
        btn.addEventListener('click', () => {
            showStep(currentStep - 1);
        });
    });

    // Affiche choix abonnement seulement si musicien
    document.getElementById('statusSelect').addEventListener('change', function() {
        if (this.value === 'musicien') {
            document.getElementById('subscriptionChoice').style.display = 'block';
        } else {
            document.getElementById('subscriptionChoice').style.display = 'none';
        }
    });

    showStep(0);
});
</script>

<style>
.step { display: none; }
.step.active { display: block; }
</style>
{% endblock %}